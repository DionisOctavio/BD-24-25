
--1--
SELECT APELLIDO, SALARIO, COMISION, SALARIO+NVL(COMISION,0) "TOTAL SUELDO"
FROM EMPLE;

SELECT AVG(SALARIO + NVL(COMISION, 0)) "SUELDO MEDIO"
FROM EMPLE;


select COUNT(COMISION)
FROM EMPLE
WHERE COMISION <> 0;


SELECT MAX(SALARIO)
FROM EMPLE;


SELECT MAX(SALARIO+COMISION) "TOTAL SUELDO"
FROM EMPLE;

SELECT MIN(SALARIO+COMISION)
FROM EMPLE
WHERE DEPT_NO = 30;

SELECT MAX(SALARIO)
FROM EMPLE
WHERE DEPT_NO = 30 AND OFICIO = 'VENDEDOR';

SELECT MAX(SALARIO+COMISION) "TOTAL SUELDO"
FROM EMPLE WHERE DEPT_NO = 30 AND OFICIO = 'VENDEDOR';

--2--

SELECT TEMA, EJEMPLARES
FROM LIBRERIA
WHERE EJEMPLARES = (SELECT MAX(EJEMPLARES) FROM LIBRERIA)
AND TEMA LIKE '%E%';

SELECT TEMA, EJEMPLARES
    FROM LIBRERIA
    WHERE EJEMPLARES = (SELECT MAX(EJEMPLARES) FROM LIBRERIA)
    AND ESTANTE = 'E';

--3--
SELECT REPLACE(REPLACE(TITULO, '"', ''), '.', '') || '-^-^-^-^-^-^-^-^-^-^'  FORMATEADO
FROM MISTEXTOS;

--4--
SELECT LOWER(REPLACE(REPLACE(TRIM(TITULO), '"', ''), '.', ''))  TITULO_FORMATO
FROM MISTEXTOS;

--5--
SELECT AUTOR, 
       TRIM(SUBSTR(AUTOR, 1, INSTR(AUTOR, ',') - 1))  APELLIDO_AUTOR
FROM LIBROS
WHERE INSTR(AUTOR, ',') > 0;

--6--

SELECT AUTOR,
TRIM(SUBSTR(AUTOR, INSTR(AUTOR, ',') + 1)) NOMBRE_AUTOR FROM LIBROS WHERE INSTR(AUTOR, ',') > 0;


--7--

SELECT CASE WHEN INSTR(AUTOR, ',') > 0 THEN TRIM(SUBSTR(AUTOR, INSTR(AUTOR, ',') + 1)) || ' ' || TRIM(SUBSTR(AUTOR, 1, INSTR(AUTOR, ',') - 1))
ELSE AUTOR END NOMBRE_COMPLETO FROM LIBROS;

--8--
SELECT TITULO FROM LIBROS ORDER BY LENGTH(TITULO);

--10--

SELECT tema, RIGHT(TRIM(tema), 1) AS ultimo_caracter, LENGTH(TRIM(tema)) AS longitud_tema
FROM LIBRERIA;

--13--

SELECT CASE WHEN ejemplares = 7 THEN 'SEVEN'  ELSE tema END  nombre_tema
FROM LIBRERIA;

--14--
SELECT apellido, FECHA_ALT FROM EMPLE
WHERE FECHA_ALT <= ADD_MONTHS(SYSDATE, -12 * 15);

--15--
SELECT APELLIDO FROM EMPLE
WHERE FECHA_ALT <= ADD_MONTHS(SYSDATE, -12 * 16) AND DEPT_NO = 30; 

--16--
SELECT APELLIDO, SALARIO, DEPT_NO FROM EMPLE
WHERE SALARIO = (SELECT MAX(SALARIO) FROM EMPLE sub WHERE sub.DEPT_NO = EMPLE.DEPT_NO);

--17--
SELECT APELLIDO, SALARIO, DEPT_NO FROM EMPLE
WHERE SALARIO > (SELECT AVG(SALARIO) FROM EMPLE sub WHERE sub.DEPT_NO = EMPLE.DEPT_NO);
