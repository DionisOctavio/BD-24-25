Los hoteles de 3 estrellas que tengo en Zaragoza

SELECT NOMBRE_HOTEL, CATEGORIA.DESCRIPCION, DIRECCION_HOTEL
FROM HOTEL
JOIN CATEGORIA ON HOTEL.ID_CATEGORIA = CATEGORIA.ID_CATEGORIA
WHERE CATEGORIA.ESTRELLA = 3
AND DIRECCION_HOTEL LIKE '%Zaragoza%';

Las suites que tengo en los hoteles de 3 estrellas que tengo en Zaragoza

SELECT NOMBRE_HOTEL, DIRECCION_HOTEL, HABITACION.CLASE_HABITACION, CATEGORIA.DESCRIPCION
FROM HOTEL
JOIN CATEGORIA ON HOTEL.ID_CATEGORIA = CATEGORIA.ID_CATEGORIA
JOIN HABITACION ON HOTEL.ID_HOTEL = HABITACION.ID_HOTEL
WHERE CATEGORIA.ESTRELLA = 3
AND HABITACION.CLASE_HABITACION = 'Suite';

Las suites libres que tengo para hoy en los hoteles de 3 estrellas que tengo en Zaragoza

SELECT NOMBRE_HOTEL, DIRECCION_HOTEL, HABITACION.CLASE_HABITACION, CATEGORIA.DESCRIPCION
FROM HOTEL
JOIN CATEGORIA ON HOTEL.ID_CATEGORIA = CATEGORIA.ID_CATEGORIA
JOIN HABITACION ON HOTEL.ID_HOTEL = HABITACION.ID_HOTEL
JOIN RESERVANTE_HABITACION ON HABITACION.ID_HABITACION = RESERVANTE_HABITACION.ID_HABITACION
WHERE CATEGORIA.ESTRELLA = 3
AND HABITACION.CLASE_HABITACION = 'Suite'
AND DIRECCION_HOTEL LIKE '%Zaragoza%'
AND HABITACION.ID_HABITACION NOT IN 
(SELECT ID_HABITACION FROM RESERVANTE_HABITACION WHERE TRUNC(SYSDATE) BETWEEN TRUNC(FECHA_INICIO) AND TRUNC(FECHA_FIN));

Las reservas para hoy que tiene el cliente "Lolo Lolez"

SELECT NOMBRE_RESERVANTE, HOTEL.NOMBRE_HOTEL, CATEGORIA.DESCRIPCION, RESERVANTE_HABITACION.FECHA_INICIO, RESERVANTE_HABITACION.FECHA_FIN
FROM RESERVANTE
JOIN RESERVANTE_HABITACION ON RESERVANTE.ID_RESERVANTE = RESERVANTE_HABITACION.ID_RESERVANTE
JOIN HABITACION ON RESERVANTE_HABITACION.ID_HABITACION = HABITACION.ID_HABITACION
JOIN HOTEL ON HABITACION.ID_HOTEL = HOTEL.ID_HOTEL
JOIN CATEGORIA ON HOTEL.ID_CATEGORIA = CATEGORIA.ID_CATEGORIA
WHERE TRUNC(RESERVANTE_HABITACION.FECHA_INICIO) = TRUNC(SYSDATE)
AND NOMBRE_RESERVANTE = 'Lolo Lolez';



Las reservas de los últimos 30 días que tiene el cliente "Lolo Lolez"

SELECT RESERVANTE.NOMBRE_RESERVANTE, PRECIO, FECHA_INICIO, FECHA_FIN
FROM RESERVANTE_HABITACION
JOIN RESERVANTE ON RESERVANTE_HABITACION.ID_RESERVANTE = RESERVANTE.ID_RESERVANTE
WHERE RESERVANTE.NOMBRE_RESERVANTE = 'Lolo Lolez'
AND TRUNC(FECHA_INICIO) >= TRUNC(SYSDATE)-30;

Las reservas de los últimos 30 días que tiene el cliente "Lolo Lolez" en hoteles de 3 estrellas de Zaragoza

SELECT RESERVANTE.NOMBRE_RESERVANTE, PRECIO, FECHA_INICIO, FECHA_FIN, HOTEL.NOMBRE_HOTEL, CATEGORIA.DESCRIPCION
FROM RESERVANTE_HABITACION
JOIN RESERVANTE ON RESERVANTE_HABITACION.ID_RESERVANTE = RESERVANTE.ID_RESERVANTE
JOIN HABITACION ON RESERVANTE_HABITACION.ID_HABITACION = HABITACION.ID_HABITACION
JOIN HOTEL ON HABITACION.ID_HOTEL = HOTEL.ID_HOTEL
JOIN CATEGORIA ON HOTEL.ID_CATEGORIA = CATEGORIA.ID_CATEGORIA
WHERE RESERVANTE.NOMBRE_RESERVANTE = 'Lolo Lolez'
AND CATEGORIA.ESTRELLA = 3
AND TRUNC(FECHA_INICIO) >= TRUNC(SYSDATE)-30
AND DIRECCION_HOTEL LIKE '%Zaragoza%';

Consultas adicionales para subir nota:
Los hoteles de 3 estrellas que tengo en Zaragoza que NO han sido reservados en la última semana (los últimos 7 días)

SELECT NOMBRE_HOTEL, CATEGORIA.DESCRIPCION, HOTEL.DIRECCION_HOTEL
FROM HOTEL
JOIN CATEGORIA ON HOTEL.ID_CATEGORIA = CATEGORIA.ID_CATEGORIA
WHERE CATEGORIA.ESTRELLA = 3
AND DIRECCION_HOTEL LIKE '%Zaragoza%'
AND HOTEL.ID_HOTEL NOT IN
(SELECT DISTINCT HABITACION.ID_HOTEL
FROM HABITACION JOIN RESERVANTE_HABITACION ON HABITACION.ID_HABITACION = RESERVANTE_HABITACION.ID_HABITACION 
WHERE RESERVANTE_HABITACION.FECHA_INICIO >= TRUNC(SYSDATE) - 7);



Los particulares de Madrid que no han reservado hotel en Zaragoza en el último mes

SELECT NOMBRE_RESERVANTE, NOMBRE_HOTEL, CATEGORIA.DESCRIPCION, HOTEL.DIRECCION_HOTEL
FROM RESERVANTE
JOIN RESERVANTE_HABITACION ON RESERVANTE.ID_RESERVANTE = RESERVANTE_HABITACION.ID_RESERVANTE
JOIN HABITACION ON RESERVANTE_HABITACION.ID_HABITACION = HABITACION.ID_HABITACION
JOIN HOTEL ON HABITACION.ID_HOTEL = HOTEL.ID_HOTEL
JOIN CATEGORIA ON HOTEL.ID_CATEGORIA = CATEGORIA.ID_CATEGORIA
WHERE DIRECCION_HOTEL LIKE '%Zaragoza%'
AND RESERVANTE.NOMBRE_RESERVANTE_AGENCIA = 'Particular'
AND DIRECCION_RESERVANTE LIKE '%Madrid%'
AND RESERVANTE.NOMBRE_RESERVANTE NOT IN (
    SELECT DISTINCT RESERVANTE.NOMBRE_RESERVANTE
    FROM RESERVANTE
    JOIN RESERVANTE_HABITACION ON RESERVANTE.ID_RESERVANTE = RESERVANTE_HABITACION.ID_RESERVANTE
    JOIN HABITACION ON RESERVANTE_HABITACION.ID_HABITACION = HABITACION.ID_HABITACION
    JOIN HOTEL ON HABITACION.ID_HOTEL = HOTEL.ID_HOTEL
    WHERE TRUNC(RESERVANTE_HABITACION.FECHA_INICIO) >= TRUNC(SYSDATE) - 30
    AND DIRECCION_HOTEL LIKE '%Zaragoza%'
    AND RESERVANTE.NOMBRE_RESERVANTE_AGENCIA = 'Particular'
);


Los particulares de Madrid que no han reservado hotel en Zaragoza de 3 estrellas en el último mes

SELECT NOMBRE_RESERVANTE, NOMBRE_HOTEL, CATEGORIA.DESCRIPCION, HOTEL.DIRECCION_HOTEL
FROM RESERVANTE
JOIN RESERVANTE_HABITACION ON RESERVANTE.ID_RESERVANTE = RESERVANTE_HABITACION.ID_RESERVANTE
JOIN HABITACION ON RESERVANTE_HABITACION.ID_HABITACION = HABITACION.ID_HABITACION
JOIN HOTEL ON HABITACION.ID_HOTEL = HOTEL.ID_HOTEL
JOIN CATEGORIA ON HOTEL.ID_CATEGORIA = CATEGORIA.ID_CATEGORIA
WHERE DIRECCION_HOTEL LIKE '%Zaragoza%'
AND RESERVANTE.NOMBRE_RESERVANTE_AGENCIA = 'Particular'
AND CATEGORIA.ESTRELLA = 3
AND DIRECCION_RESERVANTE LIKE '%Madrid%'
AND RESERVANTE.NOMBRE_RESERVANTE NOT IN (
    SELECT DISTINCT RESERVANTE.NOMBRE_RESERVANTE
    FROM RESERVANTE
    JOIN RESERVANTE_HABITACION ON RESERVANTE.ID_RESERVANTE = RESERVANTE_HABITACION.ID_RESERVANTE
    JOIN HABITACION ON RESERVANTE_HABITACION.ID_HABITACION = HABITACION.ID_HABITACION
    JOIN HOTEL ON HABITACION.ID_HOTEL = HOTEL.ID_HOTEL
    WHERE TRUNC(RESERVANTE_HABITACION.FECHA_INICIO) >= TRUNC(SYSDATE) - 30
    AND DIRECCION_HOTEL LIKE '%Zaragoza%'
    AND RESERVANTE.NOMBRE_RESERVANTE_AGENCIA = 'Particular'
);
